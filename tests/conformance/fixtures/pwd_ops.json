{
  "version": "v1",
  "family": "pwd_ops",
  "captured_at": "2026-02-13T00:00:00Z",
  "description": "Mode-specific parity fixtures for password database operations (getpwnam, getpwuid, getpwent, setpwent, endpwent, getpwnam_r, getpwuid_r). All Implemented. Strict: host-glibc parity. Hardened: missing user fallback.",
  "cases": [
    {
      "name": "getpwnam_root_strict",
      "function": "getpwnam",
      "spec_section": "POSIX getpwnam",
      "inputs": { "name": "root" },
      "expected_output": "PASSWD_PTR",
      "expected_errno": 0,
      "mode": "strict",
      "note": "root user always exists"
    },
    {
      "name": "getpwnam_nonexistent_strict",
      "function": "getpwnam",
      "spec_section": "POSIX getpwnam",
      "inputs": { "name": "nonexistent_user_xyz" },
      "expected_output": "NULL",
      "expected_errno": 0,
      "mode": "strict",
      "note": "Unknown user returns NULL without error"
    },
    {
      "name": "getpwuid_zero_strict",
      "function": "getpwuid",
      "spec_section": "POSIX getpwuid",
      "inputs": { "uid": 0 },
      "expected_output": "PASSWD_PTR",
      "expected_errno": 0,
      "mode": "strict",
      "note": "UID 0 is root"
    },
    {
      "name": "getpwuid_nonexistent_strict",
      "function": "getpwuid",
      "spec_section": "POSIX getpwuid",
      "inputs": { "uid": 99999 },
      "expected_output": "NULL",
      "expected_errno": 0,
      "mode": "strict"
    },
    {
      "name": "setpwent_endpwent_strict",
      "function": "setpwent",
      "spec_section": "POSIX setpwent/endpwent",
      "inputs": {},
      "expected_output": "VOID",
      "expected_errno": 0,
      "mode": "strict"
    },
    {
      "name": "getpwnam_root_hardened",
      "function": "getpwnam",
      "spec_section": "POSIX getpwnam",
      "inputs": { "name": "root" },
      "expected_output": "PASSWD_PTR",
      "expected_errno": 0,
      "mode": "hardened"
    },
    {
      "name": "getpwuid_zero_hardened",
      "function": "getpwuid",
      "spec_section": "POSIX getpwuid",
      "inputs": { "uid": 0 },
      "expected_output": "PASSWD_PTR",
      "expected_errno": 0,
      "mode": "hardened"
    }
  ]
}
